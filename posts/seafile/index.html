<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>使用Docker方式安装Seafile私人网盘 | Tao's Notes</title>
<meta name=keywords content="seafile,docker">
<meta name=description content="Seafile是一款开源的企业云盘，注重可靠性和性能。支持 Windows, Mac, Linux, iOS, Android 平台。支持文件同步或者直接挂载到本地访问">
<meta name=author content="Me">
<link rel=canonical href=https://zhoutao822.github.io/posts/seafile/>
<meta name=google-site-verification content="Tao">
<meta name=yandex-verification content="Tao">
<meta name=msvalidate.01 content="Tao">
<link crossorigin=anonymous href=/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css integrity="sha256-yIlj/i15RiAA/Q+xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as=style>
<script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://zhoutao822.github.io/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://zhoutao822.github.io/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://zhoutao822.github.io/favicon-32x32.png>
<link rel=apple-touch-icon href=https://zhoutao822.github.io/apple-touch-icon.png>
<link rel=mask-icon href=https://zhoutao822.github.io/favicon.ico>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.91.2">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
</noscript>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-123-45','auto'),ga('send','pageview'))</script><meta property="og:title" content="使用Docker方式安装Seafile私人网盘">
<meta property="og:description" content="Seafile是一款开源的企业云盘，注重可靠性和性能。支持 Windows, Mac, Linux, iOS, Android 平台。支持文件同步或者直接挂载到本地访问">
<meta property="og:type" content="article">
<meta property="og:url" content="https://zhoutao822.github.io/posts/seafile/"><meta property="og:image" content="https://zhoutao822.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2022-01-03T17:14:59+08:00">
<meta property="article:modified_time" content="2022-01-03T17:14:59+08:00"><meta property="og:site_name" content="Tao's Notes">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://zhoutao822.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E">
<meta name=twitter:title content="使用Docker方式安装Seafile私人网盘">
<meta name=twitter:description content="Seafile是一款开源的企业云盘，注重可靠性和性能。支持 Windows, Mac, Linux, iOS, Android 平台。支持文件同步或者直接挂载到本地访问">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://zhoutao822.github.io/posts/"},{"@type":"ListItem","position":2,"name":"使用Docker方式安装Seafile私人网盘","item":"https://zhoutao822.github.io/posts/seafile/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"使用Docker方式安装Seafile私人网盘","name":"使用Docker方式安装Seafile私人网盘","description":"Seafile是一款开源的企业云盘，注重可靠性和性能。支持 Windows, Mac, Linux, iOS, Android 平台。支持文件同步或者直接挂载到本地访问","keywords":["seafile","docker"],"articleBody":"1. Ubuntu服务器安装docker 参考Docker方式安装chevereto图床\n2. 配置docker-compose 首先在根目录下创建一个隐藏文件夹.seafile存放我们的配置文件以及挂载的数据卷，进入.seafile目录，并新建一个docker-compose.yml文件，docker-compose.yml内容如下，需要自行配置管理员账号和密码（尽量不要修改80:80端口映射，我修改为其他端口号会导致拒绝访问），seafile-mysql、seafile-data启动后会自动生成：\nversion: '2.0' services: db: image: mariadb:10.1 container_name: seafile-mysql environment: - MYSQL_ROOT_PASSWORD=root  # Requested, set the root's password of MySQL service. - MYSQL_LOG_CONSOLE=true # 挂载容器mysql数据到本地文件夹seafile-mysql volumes: - ./seafile-mysql:/var/lib/mysql  # Requested, specifies the path to MySQL data persistent store. networks: - seafile-net memcached: image: memcached:1.5.6 container_name: seafile-memcached entrypoint: memcached -m 256 networks: - seafile-net seafile: image: seafileltd/seafile-mc container_name: seafile ports: - \"80:80\" # - \"443:443\" # If https is enabled, cancel the comment. # 挂载云盘数据到本地文件夹seafile-data volumes: - ./seafile-data:/shared  # Requested, specifies the path to Seafile data persistent store. environment: - DB_HOST=db - DB_ROOT_PASSWD=root  # Requested, the value shuold be root's password of MySQL service. #- TIME_ZONE=Asia/Shanghai # Optional, default is UTC. Should be uncomment and set to your local time zone. - SEAFILE_ADMIN_EMAIL=aaa@aaa.com # Specifies Seafile admin user, default is 'me@example.com'. - SEAFILE_ADMIN_PASSWORD=password  # Specifies Seafile admin password, default is 'asecret'. - SEAFILE_SERVER_LETSENCRYPT=false  # Whether use letsencrypt to generate cert. - SEAFILE_SERVER_HOSTNAME=175.24.47.141 # Specifies your host name. depends_on: - db - memcached networks: - seafile-net networks: seafile-net: 不用修改权限，最后启动docker-compose up -d，然后就可以通过IP+端口号（如果配置了域名也可以用域名）访问seafile云盘了（应该只能通过http访问，https是不可以的，除非配置过）。首次登录如下：\n测试上传文件\n3. 数据迁移 同理，上面我们的seafile-mysql文件夹保存的是我们的账号信息等等，seafile-data保存了我们上传的文件数据、日志信息，如果我们需要从当前服务器迁移到另一个服务器只需要保存好.seafile中的所有内容，然后全部放到另一个服务器的.seafile目录中，不用设置权限，然后安装docker和docker-compose，然后执行docker-compose up -d就可以直接运行，我们的数据也会一起同步过来。\n4. 启动seafile容器出错 如果启动seafile容器后无法访问，需要重新配置时，务必先执行docker-compose kill和docker-compose rm停止并删除容器，再删除掉seafile-mysql和seafile-data两个文件夹，之后再重新启动docker-compose up -d。\n参考： 用 Docker 部署 Seafile 服务\n","wordCount":"193","inLanguage":"en","datePublished":"2022-01-03T17:14:59+08:00","dateModified":"2022-01-03T17:14:59+08:00","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zhoutao822.github.io/posts/seafile/"},"publisher":{"@type":"Organization","name":"Tao's Notes","logo":{"@type":"ImageObject","url":"https://zhoutao822.github.io/favicon.ico"}}}</script>
</head>
<body class=dark id=top>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://zhoutao822.github.io/ accesskey=h title="Home (Alt + H)">Home</a>
<span class=logo-switches>
</span>
</div>
<ul id=menu>
<li>
<a href=https://zhoutao822.github.io/archives/ title=Archive>
<span>Archive</span>
</a>
</li>
<li>
<a href=https://zhoutao822.github.io/tags/ title=Tags>
<span>Tags</span>
</a>
</li>
<li>
<a href=https://zhoutao822.github.io/categories/ title=Categories>
<span>Categories</span>
</a>
</li>
<li>
<a href=https://zhoutao822.github.io/series/ title=Series>
<span>Series</span>
</a>
</li>
<li>
<a href=https://zhoutao822.github.io/search/ title="Search (Alt + /)" accesskey=/>
<span>Search</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<div class=breadcrumbs><a href=https://zhoutao822.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://zhoutao822.github.io/posts/>Posts</a></div>
<h1 class=post-title>
使用Docker方式安装Seafile私人网盘
</h1>
<div class=post-meta><span title="2022-01-03 17:14:59 +0800 +0800">January 3, 2022</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/Zhoutao822/zhoutao822.github.io/tree/main/content//posts/seafile.md rel="noopener noreferrer" target=_blank>Suggest Changes</a>
</div>
</header> <div class=toc>
<details>
<summary accesskey=c title="(Alt + C)">
<span class=details>Table of Contents</span>
</summary>
<div class=inner><ul>
<li>
<a href=#1-ubuntu%e6%9c%8d%e5%8a%a1%e5%99%a8%e5%ae%89%e8%a3%85docker aria-label="1. Ubuntu服务器安装docker">1. Ubuntu服务器安装docker</a></li>
<li>
<a href=#2-%e9%85%8d%e7%bd%aedocker-compose aria-label="2. 配置docker-compose">2. 配置docker-compose</a></li>
<li>
<a href=#3-%e6%95%b0%e6%8d%ae%e8%bf%81%e7%a7%bb aria-label="3. 数据迁移">3. 数据迁移</a></li>
<li>
<a href=#4-%e5%90%af%e5%8a%a8seafile%e5%ae%b9%e5%99%a8%e5%87%ba%e9%94%99 aria-label="4. 启动seafile容器出错">4. 启动seafile容器出错</a></li>
<li>
<a href=#%e5%8f%82%e8%80%83 aria-label=参考：>参考：</a>
</li>
</ul>
</div>
</details>
</div>
<div class=post-content><h2 id=1-ubuntu服务器安装docker>1. Ubuntu服务器安装docker<a hidden class=anchor aria-hidden=true href=#1-ubuntu服务器安装docker>#</a></h2>
<p>参考<a href=https://zhoutao822.github.io/posts/chevereto/>Docker方式安装chevereto图床</a></p>
<h2 id=2-配置docker-compose>2. 配置docker-compose<a hidden class=anchor aria-hidden=true href=#2-配置docker-compose>#</a></h2>
<p>首先在根目录下创建一个隐藏文件夹<code>.seafile</code>存放我们的配置文件以及挂载的数据卷，进入<code>.seafile</code>目录，并新建一个<code>docker-compose.yml</code>文件，<code>docker-compose.yml</code>内容如下，需要自行配置管理员账号和密码（<strong>尽量不要修改80:80端口映射，我修改为其他端口号会导致拒绝访问</strong>），<code>seafile-mysql、seafile-data</code>启动后会自动生成：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=color:#f92672>version</span>: <span style=color:#e6db74>&#39;2.0&#39;</span>
<span style=color:#f92672>services</span>:
  <span style=color:#f92672>db</span>:
    <span style=color:#f92672>image</span>: <span style=color:#ae81ff>mariadb:10.1</span>
    <span style=color:#f92672>container_name</span>: <span style=color:#ae81ff>seafile-mysql</span>
    <span style=color:#f92672>environment</span>:
      - <span style=color:#ae81ff>MYSQL_ROOT_PASSWORD=root </span> <span style=color:#75715e># Requested, set the root&#39;s password of MySQL service.</span>
      - <span style=color:#ae81ff>MYSQL_LOG_CONSOLE=true</span>
    <span style=color:#75715e># 挂载容器mysql数据到本地文件夹seafile-mysql</span>
    <span style=color:#f92672>volumes</span>:
      - <span style=color:#ae81ff>./seafile-mysql:/var/lib/mysql </span> <span style=color:#75715e># Requested, specifies the path to MySQL data persistent store.</span>
    <span style=color:#f92672>networks</span>:
      - <span style=color:#ae81ff>seafile-net</span>

  <span style=color:#f92672>memcached</span>:
    <span style=color:#f92672>image</span>: <span style=color:#ae81ff>memcached:1.5.6</span>
    <span style=color:#f92672>container_name</span>: <span style=color:#ae81ff>seafile-memcached</span>
    <span style=color:#f92672>entrypoint</span>: <span style=color:#ae81ff>memcached -m 256</span>
    <span style=color:#f92672>networks</span>:
      - <span style=color:#ae81ff>seafile-net</span>
          
  <span style=color:#f92672>seafile</span>:
    <span style=color:#f92672>image</span>: <span style=color:#ae81ff>seafileltd/seafile-mc</span>
    <span style=color:#f92672>container_name</span>: <span style=color:#ae81ff>seafile</span>
    <span style=color:#f92672>ports</span>:
      - <span style=color:#e6db74>&#34;80:80&#34;</span>
      <span style=color:#75715e># - &#34;443:443&#34;  # If https is enabled, cancel the comment.</span>
    <span style=color:#75715e># 挂载云盘数据到本地文件夹seafile-data</span>
    <span style=color:#f92672>volumes</span>:
      - <span style=color:#ae81ff>./seafile-data:/shared  </span> <span style=color:#75715e># Requested, specifies the path to Seafile data persistent store.</span>
    <span style=color:#f92672>environment</span>:
      - <span style=color:#ae81ff>DB_HOST=db</span>
      - <span style=color:#ae81ff>DB_ROOT_PASSWD=root </span> <span style=color:#75715e># Requested, the value shuold be root&#39;s password of MySQL service.</span>
        <span style=color:#75715e>#- TIME_ZONE=Asia/Shanghai # Optional, default is UTC. Should be uncomment and set to your local time zone.</span>
      - <span style=color:#ae81ff>SEAFILE_ADMIN_EMAIL=aaa@aaa.com</span> <span style=color:#75715e># Specifies Seafile admin user, default is &#39;me@example.com&#39;.</span>
      - <span style=color:#ae81ff>SEAFILE_ADMIN_PASSWORD=password    </span> <span style=color:#75715e># Specifies Seafile admin password, default is &#39;asecret&#39;.</span>
      - <span style=color:#ae81ff>SEAFILE_SERVER_LETSENCRYPT=false  </span> <span style=color:#75715e># Whether use letsencrypt to generate cert.</span>
      - <span style=color:#ae81ff>SEAFILE_SERVER_HOSTNAME=175.24.47.141</span> <span style=color:#75715e># Specifies your host name.</span>
    <span style=color:#f92672>depends_on</span>:
      - <span style=color:#ae81ff>db</span>
      - <span style=color:#ae81ff>memcached</span>
    <span style=color:#f92672>networks</span>:
      - <span style=color:#ae81ff>seafile-net</span>

<span style=color:#f92672>networks</span>:
  <span style=color:#f92672>seafile-net</span>:
</code></pre></div><p>不用修改权限，最后启动<code>docker-compose up -d</code>，然后就可以通过IP+端口号（如果配置了域名也可以用域名）访问seafile云盘了（<strong>应该只能通过http访问，https是不可以的，除非配置过</strong>）。首次登录如下：</p>
<p><img loading=lazy src=https://gitee.com/tao2333/hugo-pic/raw/master/pictures/202201031718577.PNG alt=seafile1>
</p>
<p>测试上传文件</p>
<p><img loading=lazy src=https://gitee.com/tao2333/hugo-pic/raw/master/pictures/202201031718273.PNG alt=seafile2>
</p>
<h2 id=3-数据迁移>3. 数据迁移<a hidden class=anchor aria-hidden=true href=#3-数据迁移>#</a></h2>
<p>同理，上面我们的<code>seafile-mysql</code>文件夹保存的是我们的账号信息等等，<code>seafile-data</code>保存了我们上传的文件数据、日志信息，如果我们需要从当前服务器迁移到另一个服务器只需要保存好<code>.seafile</code>中的所有内容，然后全部放到另一个服务器的<code>.seafile</code>目录中，不用设置权限，然后安装<code>docker</code>和<code>docker-compose</code>，然后执行<code>docker-compose up -d</code>就可以直接运行，我们的数据也会一起同步过来。</p>
<h2 id=4-启动seafile容器出错>4. 启动seafile容器出错<a hidden class=anchor aria-hidden=true href=#4-启动seafile容器出错>#</a></h2>
<p>如果启动seafile容器后无法访问，需要重新配置时，<strong>务必先执行<code>docker-compose kill</code>和<code>docker-compose rm</code>停止并删除容器，再删除掉<code>seafile-mysql</code>和<code>seafile-data</code>两个文件夹</strong>，之后再重新启动<code>docker-compose up -d</code>。</p>
<h2 id=参考>参考：<a hidden class=anchor aria-hidden=true href=#参考>#</a></h2>
<p><a href=https://cloud.seafile.com/published/seafile-manual-cn/docker/%E7%94%A8Docker%E9%83%A8%E7%BD%B2Seafile.md>用 Docker 部署 Seafile 服务</a></p>
</div>
<footer class=post-footer>
<ul class=post-tags>
<li><a href=https://zhoutao822.github.io/tags/seafile/>seafile</a></li>
<li><a href=https://zhoutao822.github.io/tags/docker/>docker</a></li>
</ul>
<nav class=paginav>
<a class=prev href=https://zhoutao822.github.io/posts/chevereto/>
<span class=title>« Prev Page</span>
<br>
<span>使用Docker方式安装chevereto图床</span>
</a>
<a class=next href=https://zhoutao822.github.io/posts/k3s-on-mac/>
<span class=title>Next Page »</span>
<br>
<span>K3s on Mac</span>
</a>
</nav>
</footer>
<script src=https://utteranc.es/client.js repo=zhoutao822/zhoutao822.github.io issue-term=title theme=github-dark crossorigin=anonymous async></script>
</article>
</main>
<footer class=footer>
<span>&copy; 2022 <a href=https://zhoutao822.github.io/>Tao's Notes</a></span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='copy';function d(){a.innerText='copied!',setTimeout(()=>{a.innerText='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script>
</body>
</html>