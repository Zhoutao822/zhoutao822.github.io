<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Material组件-Snackbar | Tao's Notes</title><meta name=keywords content="Snackbar"><meta name=description content="Snackbar是类似与Toast的一种信息提示控件，但是与Toast不同的是Snackbar是从界面底部弹出的且支持一个点击事件，默认情况下Snackbar内部有两个子控件分别是TextView和Button，两者水平排列，TextView用于显示信息，Button用于实现点击事件。"><meta name=author content="Me"><link rel=canonical href=https://zhoutao822.github.io/posts/snackbar/><meta name=google-site-verification content="Tao"><meta name=yandex-verification content="Tao"><meta name=msvalidate.01 content="Tao"><link crossorigin=anonymous href=/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css integrity="sha256-yIlj/i15RiAA/Q+xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.b95bacdc39e37a332a9f883b1e78be4abc1fdca2bc1f2641f55e3cd3dabd4d61.js integrity="sha256-uVus3DnjejMqn4g7Hni+Srwf3KK8HyZB9V4809q9TWE=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://zhoutao822.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://zhoutao822.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://zhoutao822.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://zhoutao822.github.io/apple-touch-icon.png><link rel=mask-icon href=https://zhoutao822.github.io/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.103.1"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="Material组件-Snackbar"><meta property="og:description" content="Snackbar是类似与Toast的一种信息提示控件，但是与Toast不同的是Snackbar是从界面底部弹出的且支持一个点击事件，默认情况下Snackbar内部有两个子控件分别是TextView和Button，两者水平排列，TextView用于显示信息，Button用于实现点击事件。"><meta property="og:type" content="article"><meta property="og:url" content="https://zhoutao822.github.io/posts/snackbar/"><meta property="og:image" content="https://zhoutao822.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-07-23T21:46:04+08:00"><meta property="article:modified_time" content="2019-07-23T21:46:04+08:00"><meta property="og:site_name" content="Tao's Notes"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://zhoutao822.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Material组件-Snackbar"><meta name=twitter:description content="Snackbar是类似与Toast的一种信息提示控件，但是与Toast不同的是Snackbar是从界面底部弹出的且支持一个点击事件，默认情况下Snackbar内部有两个子控件分别是TextView和Button，两者水平排列，TextView用于显示信息，Button用于实现点击事件。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://zhoutao822.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Material组件-Snackbar","item":"https://zhoutao822.github.io/posts/snackbar/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Material组件-Snackbar","name":"Material组件-Snackbar","description":"Snackbar是类似与Toast的一种信息提示控件，但是与Toast不同的是Snackbar是从界面底部弹出的且支持一个点击事件，默认情况下Snackbar内部有两个子控件分别是TextView和Button，两者水平排列，TextView用于显示信息，Button用于实现点击事件。","keywords":["Snackbar"],"articleBody":"Snackbar是类似与Toast的一种信息提示控件，但是与Toast不同的是Snackbar是从界面底部弹出的且支持一个点击事件，默认情况下Snackbar内部有两个子控件分别是TextView和Button，两者水平排列，TextView用于显示信息，Button用于实现点击事件。\n1. Snackbar使用 Snackbar属于Material组件中的一种，如果你的应用使用了Material Theme以及AppCompatActivity，则Snackbar会获得圆角、四周有margin空隙的效果。\n默认情况下使用Snackbar，调用的方式也非常类似Toast\n// view是当前页面内的某个view，根据源码可知，make方法会找view的父view， // 直到父view是FrameLayout或者CoordinateLayout，然后将其作为root给inflate方法调用 // inflate会加载默认的布局文件，这里根据是否使用Material Theme会加载不同的布局文件， // 即上文我提到的效果，与此同时会将text的内容赋给布局文件中的TextView， // 如果父view是CoordinateLayout，则Snackbar还支持右滑取消的功能， // Snackbar.LENGTH_SHORT就类似于Toast.LENGTH_SHORT用于控制Snackbar的持续时间 Snackbar snackbar = Snackbar.make(view, text, Snackbar.LENGTH_SHORT); snackbar.show(); 2. Snackbar自定义Content 显然原生的Snackbar没有提供setContentView的方法，为了能够自定义Snackbar的布局，我们需要对Snackbar的一些参数进行修改，比如如果我们需要自定义Snackbar的margin以及自定义Snackbar的内容\npublic class SnackbarUtil { private int duration; private View anchor; private ViewGroup customView; private int sideMargin; private int bottomMargin; private Snackbar delegete; /** * SnackbarUtil is used to create Snackbar, if you setEnableCustom(false) or in default * you will get the origin Snackbar from Snackbar.make(anchor, text, duration); if you * setEnableCustom(true) in Builder, you must add your defined customView and you can * modify the margin of the customView in Snackbar. * * Your customView's layout should container 2 layer of Layout, because there is some * UI bug if you just only use 1 layer * * \u003c?xml version=\"1.0\" encoding=\"utf-8\"?\u003e * ","wordCount":"622","inLanguage":"en","datePublished":"2019-07-23T21:46:04+08:00","dateModified":"2019-07-23T21:46:04+08:00","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zhoutao822.github.io/posts/snackbar/"},"publisher":{"@type":"Organization","name":"Tao's Notes","logo":{"@type":"ImageObject","url":"https://zhoutao822.github.io/favicon.ico"}}}</script></head><body class=dark id=top><header class=header><nav class=nav><div class=logo><a href=https://zhoutao822.github.io/ accesskey=h title="Home (Alt + H)">Home</a>
<span class=logo-switches></span></div><ul id=menu><li><a href=https://zhoutao822.github.io/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://zhoutao822.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://zhoutao822.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://zhoutao822.github.io/series/ title=Series><span>Series</span></a></li><li><a href=https://zhoutao822.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://zhoutao822.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://zhoutao822.github.io/posts/>Posts</a></div><h1 class=post-title>Material组件-Snackbar</h1><div class=post-meta><span title='2019-07-23 21:46:04 +0800 +0800'>July 23, 2019</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/Zhoutao822/zhoutao822.github.io/tree/main/content//posts/Snackbar.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#1-snackbar%e4%bd%bf%e7%94%a8 aria-label="1. Snackbar使用">1. Snackbar使用</a></li><li><a href=#2-snackbar%e8%87%aa%e5%ae%9a%e4%b9%89content aria-label="2. Snackbar自定义Content">2. Snackbar自定义Content</a></li><li><a href=#%e5%8f%82%e8%80%83 aria-label=参考：>参考：</a></li></ul></div></details></div><div class=post-content><p>Snackbar是类似与Toast的一种信息提示控件，但是与Toast不同的是Snackbar是从界面底部弹出的且支持一个点击事件，默认情况下Snackbar内部有两个子控件分别是TextView和Button，两者水平排列，TextView用于显示信息，Button用于实现点击事件。</p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/Zhoutao822/hugo-pic/pictures/snackbar0.gif alt=snackbar0></p><h2 id=1-snackbar使用>1. Snackbar使用<a hidden class=anchor aria-hidden=true href=#1-snackbar使用>#</a></h2><p>Snackbar属于Material组件中的一种，如果你的应用使用了Material Theme以及AppCompatActivity，则Snackbar会获得圆角、四周有margin空隙的效果。</p><p>默认情况下使用Snackbar，调用的方式也非常类似Toast</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// view是当前页面内的某个view，根据源码可知，make方法会找view的父view，
</span></span></span><span style=display:flex><span><span style=color:#75715e>// 直到父view是FrameLayout或者CoordinateLayout，然后将其作为root给inflate方法调用
</span></span></span><span style=display:flex><span><span style=color:#75715e>// inflate会加载默认的布局文件，这里根据是否使用Material Theme会加载不同的布局文件，
</span></span></span><span style=display:flex><span><span style=color:#75715e>// 即上文我提到的效果，与此同时会将text的内容赋给布局文件中的TextView，
</span></span></span><span style=display:flex><span><span style=color:#75715e>// 如果父view是CoordinateLayout，则Snackbar还支持右滑取消的功能，
</span></span></span><span style=display:flex><span><span style=color:#75715e>// Snackbar.LENGTH_SHORT就类似于Toast.LENGTH_SHORT用于控制Snackbar的持续时间
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>Snackbar snackbar <span style=color:#f92672>=</span> Snackbar<span style=color:#f92672>.</span><span style=color:#a6e22e>make</span><span style=color:#f92672>(</span>view<span style=color:#f92672>,</span> text<span style=color:#f92672>,</span> Snackbar<span style=color:#f92672>.</span><span style=color:#a6e22e>LENGTH_SHORT</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>snackbar<span style=color:#f92672>.</span><span style=color:#a6e22e>show</span><span style=color:#f92672>();</span>
</span></span></code></pre></div><h2 id=2-snackbar自定义content>2. Snackbar自定义Content<a hidden class=anchor aria-hidden=true href=#2-snackbar自定义content>#</a></h2><p>显然原生的Snackbar没有提供setContentView的方法，为了能够自定义Snackbar的布局，我们需要对Snackbar的一些参数进行修改，比如如果我们需要自定义Snackbar的margin以及自定义Snackbar的内容</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>SnackbarUtil</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span> duration<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> View anchor<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> ViewGroup customView<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span> sideMargin<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span> bottomMargin<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> Snackbar delegete<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * SnackbarUtil is used to create Snackbar, if you setEnableCustom(false) or in default
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * you will get the origin Snackbar from Snackbar.make(anchor, text, duration); if you
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * setEnableCustom(true) in Builder, you must add your defined customView and you can
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * modify the margin of the customView in Snackbar.
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * Your customView&#39;s layout should container 2 layer of Layout, because there is some
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * UI bug if you just only use 1 layer
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * &lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * &lt;LinearLayout xmlns:android=&#34;http://schemas.android.com/apk/res/android&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * android:layout_width=&#34;match_parent&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * android:layout_height=&#34;match_parent&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *      &lt;LinearLayout
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *      android:layout_width=&#34;match_parent&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *      android:layout_height=&#34;wrap_content&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *      android:background=&#34;@drawable/radius_background&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *      android:orientation=&#34;vertical&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *          &lt;TextView
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *          android:layout_width=&#34;wrap_content&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *          android:layout_height=&#34;wrap_content&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *          android:layout_gravity=&#34;center&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *          android:padding=&#34;8dp&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *          android:id=&#34;@+id/textView&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *          android:text=&#34;hahahahh&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *          android:textColor=&#34;@color/colorPrimaryDark&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *          android:textSize=&#34;24sp&#34; /&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *      &lt;/LinearLayout&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * &lt;/LinearLayout&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * Usage:
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * snackView is your customView, layout_snackbar is the layout above.
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * button is the anchor view, if your button is in CoordinatorLayout
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * the snackbar can be dismissed with swipe action.
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * ViewGroup snackView = (ViewGroup) LayoutInflater.from(MainActivity.this).inflate(
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *                                      R.layout.layout_snackbar,
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *                                      new LinearLayout(MainActivity.this),
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *                                      false);
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * TextView textView = snackView.findViewById(R.id.textView);
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * textView.setOnClickListener(new View.OnClickListener() {
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @param duration     Snackbar duration, default Snackbar.LENGTH_SHORT;
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @param anchor       must need, with anchor the Snackbar will find its root;
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @param customView   must need if setEnableCustom(true) in Builder;
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @param sideMargin   customView left and right margin in Snackbar;
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @param bottomMargin customView bottom margin in Snackbar;
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * @Override public void onClick(View v) {
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * Toast.makeText(MainActivity.this, &#34;12121&#34;, Toast.LENGTH_LONG).show();
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * }
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * });
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * Snackbar snackbar = new SnackbarUtil.Builder()
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *                  .setAnchor(button)
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *                  .setBottomMargin(80)
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *                  .setDuration(Snackbar.LENGTH_SHORT)
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *                  .setText(&#34;32323&#34;)
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *                  .setCustomView(snackView)
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *                  .setSideMargin(20)
</span></span></span><span style=display:flex><span><span style=color:#75715e>     *                  .build();
</span></span></span><span style=display:flex><span><span style=color:#75715e>     * snackbar.show();
</span></span></span><span style=display:flex><span><span style=color:#75715e>     */</span>
</span></span><span style=display:flex><span>    SnackbarUtil<span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> duration<span style=color:#f92672>,</span> View anchor<span style=color:#f92672>,</span> ViewGroup customView<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> sideMargin<span style=color:#f92672>,</span> <span style=color:#66d9ef>int</span> bottomMargin<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>duration</span> <span style=color:#f92672>=</span> duration<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>anchor</span> <span style=color:#f92672>=</span> anchor<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>customView</span> <span style=color:#f92672>=</span> customView<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>sideMargin</span> <span style=color:#f92672>=</span> sideMargin<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>bottomMargin</span> <span style=color:#f92672>=</span> bottomMargin<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>delegete</span> <span style=color:#f92672>=</span> Snackbar<span style=color:#f92672>.</span><span style=color:#a6e22e>make</span><span style=color:#f92672>(</span>anchor<span style=color:#f92672>,</span> <span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>,</span> duration<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> Snackbar <span style=color:#a6e22e>create</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 通过getView获取Snackbar的layout
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        Snackbar<span style=color:#f92672>.</span><span style=color:#a6e22e>SnackbarLayout</span> layout <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>Snackbar<span style=color:#f92672>.</span><span style=color:#a6e22e>SnackbarLayout</span><span style=color:#f92672>)</span> delegete<span style=color:#f92672>.</span><span style=color:#a6e22e>getView</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 为了自定义margin，这里需要将Snackbar的背景设置为透明，textView可以设置为INVISIBLE也可以不设置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// 只要没有在make加入text即可
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        layout<span style=color:#f92672>.</span><span style=color:#a6e22e>setBackgroundColor</span><span style=color:#f92672>(</span>Color<span style=color:#f92672>.</span><span style=color:#a6e22e>TRANSPARENT</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        TextView textView <span style=color:#f92672>=</span> layout<span style=color:#f92672>.</span><span style=color:#a6e22e>findViewById</span><span style=color:#f92672>(</span>com<span style=color:#f92672>.</span><span style=color:#a6e22e>google</span><span style=color:#f92672>.</span><span style=color:#a6e22e>android</span><span style=color:#f92672>.</span><span style=color:#a6e22e>material</span><span style=color:#f92672>.</span><span style=color:#a6e22e>R</span><span style=color:#f92672>.</span><span style=color:#a6e22e>id</span><span style=color:#f92672>.</span><span style=color:#a6e22e>snackbar_text</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        textView<span style=color:#f92672>.</span><span style=color:#a6e22e>setVisibility</span><span style=color:#f92672>(</span>View<span style=color:#f92672>.</span><span style=color:#a6e22e>INVISIBLE</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// customView为我们传入的自定义view，自定义view是如何调用inflate可以参考注释，
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// 但是customView必须包含两层layout这是因为UI上有bug，具体可以自行测试，
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// 所以我们实际设置的margin是第2层layout的margin，第2层layout有背景色，
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// 所以最终呈现出Snackbar有margin的效果，但是要知道实际上Snackbar的布局
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// 还是占据了整个底部空间
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        View childLayout <span style=color:#f92672>=</span> customView<span style=color:#f92672>.</span><span style=color:#a6e22e>getChildAt</span><span style=color:#f92672>(</span>0<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>final</span> ViewGroup<span style=color:#f92672>.</span><span style=color:#a6e22e>MarginLayoutParams</span> params <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>ViewGroup<span style=color:#f92672>.</span><span style=color:#a6e22e>MarginLayoutParams</span><span style=color:#f92672>)</span> childLayout<span style=color:#f92672>.</span><span style=color:#a6e22e>getLayoutParams</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// MarginLayoutParams设置margin
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        params<span style=color:#f92672>.</span><span style=color:#a6e22e>setMargins</span><span style=color:#f92672>(</span>params<span style=color:#f92672>.</span><span style=color:#a6e22e>leftMargin</span> <span style=color:#f92672>+</span> sideMargin<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                params<span style=color:#f92672>.</span><span style=color:#a6e22e>topMargin</span><span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                params<span style=color:#f92672>.</span><span style=color:#a6e22e>rightMargin</span> <span style=color:#f92672>+</span> sideMargin<span style=color:#f92672>,</span>
</span></span><span style=display:flex><span>                params<span style=color:#f92672>.</span><span style=color:#a6e22e>bottomMargin</span> <span style=color:#f92672>+</span> bottomMargin<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        childLayout<span style=color:#f92672>.</span><span style=color:#a6e22e>setLayoutParams</span><span style=color:#f92672>(</span>params<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Add the view to the Snackbar&#39;s layout
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        layout<span style=color:#f92672>.</span><span style=color:#a6e22e>addView</span><span style=color:#f92672>(</span>customView<span style=color:#f92672>,</span> 0<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// Show the Snackbar
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>return</span> delegete<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 由于参数较多，所以采用建造者模式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>final</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Builder</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>boolean</span> enableCustom<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> String text<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span> duration<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> View anchor<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> ViewGroup customView<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span> sideMargin<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span> bottomMargin<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        Builder<span style=color:#f92672>(</span><span style=color:#66d9ef>boolean</span> enableCustom<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>enableCustom</span> <span style=color:#f92672>=</span> enableCustom<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>duration</span> <span style=color:#f92672>=</span> Snackbar<span style=color:#f92672>.</span><span style=color:#a6e22e>LENGTH_SHORT</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>text</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>sideMargin</span> <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>bottomMargin</span> <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>Builder</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span><span style=color:#f92672>(</span><span style=color:#66d9ef>false</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> Builder <span style=color:#a6e22e>setEnableCustom</span><span style=color:#f92672>(</span><span style=color:#66d9ef>boolean</span> enableCustom<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>enableCustom</span> <span style=color:#f92672>=</span> enableCustom<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>this</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> Builder <span style=color:#a6e22e>setText</span><span style=color:#f92672>(</span>String text<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>text</span> <span style=color:#f92672>=</span> text<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>this</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> Builder <span style=color:#a6e22e>setDuration</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> duration<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>duration</span> <span style=color:#f92672>=</span> duration<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>this</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> Builder <span style=color:#a6e22e>setAnchor</span><span style=color:#f92672>(</span>View anchor<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>anchor</span> <span style=color:#f92672>=</span> anchor<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>this</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> Builder <span style=color:#a6e22e>setCustomView</span><span style=color:#f92672>(</span>ViewGroup customView<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>customView</span> <span style=color:#f92672>=</span> customView<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>this</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> Builder <span style=color:#a6e22e>setSideMargin</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> sideMargin<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>sideMargin</span> <span style=color:#f92672>=</span> sideMargin<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>this</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> Builder <span style=color:#a6e22e>setBottomMargin</span><span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> bottomMargin<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>bottomMargin</span> <span style=color:#f92672>=</span> bottomMargin<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>this</span><span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>public</span> Snackbar <span style=color:#a6e22e>build</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 通过enableCustom控制是否使用自定义Content，自定义Content的点击事件需要
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#75715e>// 在Snackbar的外面处理
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(!</span>enableCustom<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> Snackbar<span style=color:#f92672>.</span><span style=color:#a6e22e>make</span><span style=color:#f92672>(</span>anchor<span style=color:#f92672>,</span> text<span style=color:#f92672>,</span> duration<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>anchor <span style=color:#f92672>==</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> IllegalArgumentException<span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>                        <span style=color:#e6db74>&#34;No suitable parent found from the given view. Please provide a valid view.&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>customView <span style=color:#f92672>==</span> <span style=color:#66d9ef>null</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> IllegalArgumentException<span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>                        <span style=color:#e6db74>&#34;No custom view found. Please provide a valid view or setEnableCustom(false).&#34;</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> SnackbarUtil<span style=color:#f92672>(</span>duration<span style=color:#f92672>,</span> anchor<span style=color:#f92672>,</span> customView<span style=color:#f92672>,</span> sideMargin<span style=color:#f92672>,</span> bottomMargin<span style=color:#f92672>).</span><span style=color:#a6e22e>create</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>最终效果</p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/Zhoutao822/hugo-pic/pictures/snackbar1.gif alt=snackbar1></p><h2 id=参考>参考：<a hidden class=anchor aria-hidden=true href=#参考>#</a></h2><ol><li><a href=https://material.io/collections/developer-tutorials/>MATERIAL DESIGN</a></li></ol></div><footer class=post-footer><ul class=post-tags><li><a href=https://zhoutao822.github.io/tags/snackbar/>Snackbar</a></li></ul><nav class=paginav><a class=prev href=https://zhoutao822.github.io/posts/rxjava/><span class=title>« Prev Page</span><br><span>Android框架-RxJava</span></a>
<a class=next href=https://zhoutao822.github.io/posts/gson/><span class=title>Next Page »</span><br><span>Android框架-Gson</span></a></nav></footer><script src=https://utteranc.es/client.js repo=zhoutao822/zhoutao822.github.io issue-term=title theme=github-dark crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2022 <a href=https://zhoutao822.github.io/>Tao's Notes</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>